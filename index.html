<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>liiiiife.cn</title>
  </head>
  <style>     
    body,html{
      height:99%;
      width:99%;
    }
    *{
      margin:0;
      padding:0;
    }
  </style>
  <body onload="loadyearpassed()">
    <div style="width:100%;height:100%;">
      <table style="width:100%;height:100%;">
        <tr>
          <td align="center" valign="top" style="padding:20px">liiiiife.cn</td>
        </tr>
        <tr>
          <td align="center">
            <table id="mytable" style="width:100%;" cellspacing="20">
            </table>
          </td>
        </tr>
        <tr>
          <td align="center" valign="bottom">© 2020 liiiiife.cn</td>
        </tr>
      </table>
    </div>
  </body>
</html>

<script>
  function loadyearpassed(e){
    var now = new Date();
    var start = new Date(now.getFullYear(), 0, 1);
    var end = new Date(now.getFullYear()+1, 0, 1);
    var oneDay = 1000 * 60 * 60 * 24;

    var dayp = Math.floor(Math.floor((now-start)/oneDay)/Math.floor((end-start)/oneDay)*300);

    var progress_color = '#EA4335';
    if (dayp < 75) {
      // 绿色
      progress_color = '#34A853';
    } else if (dayp < 150) {
      // 蓝色
      progress_color = '#4285F4';
    } else if (dayp < 225) {
      // 橙色
      progress_color = '#FBBC05';
    } else {
      // 红色
      progress_color = '#EA4335';
    }

    var hstr = '';
    hstr += '<tr><td align="center">这是你的' + now.getFullYear() + '年</td></tr>';

    hstr += '<tr><td align="center">';

    hstr += '<table border="0" border="0" cellspacing="0" cellpadding="0"><tr>';

    for (var d=0;d<300;d++){
      if(d<dayp){
        hstr += '<td width="1" height="30" style="border:0px;background:'+progress_color+';"></td>';
      }else{
        hstr += '<td width="1" height="30" style="border:0px;background:#eeeeee;"></td>';
      }
    }

    hstr += '</tr></table>';

    hstr += '</td></tr>';

    hstr += '<tr><td align="center">它已经过去了'+ Math.round(Math.floor((now-start)/oneDay)/Math.floor((end-start)/oneDay)*10000,2)/100 +'%</td></tr>';


    hstr += '<tr><td align="center" style="padding:50px"><img src="liiiiife.jpg" height="120" width="120" /> ';
    hstr += '<img src="liiiiifemp.jpg" height="120" width="120" /></td></tr>';


    hstr += '<tr><td align="center">？？？你的人生呢 ？？？</td></tr>';

    hstr += '<tr><td align="center" style="padding-top:30px" onclick="loadlifepassed();">︾ ︾ ︾</td></tr>';

    document.getElementById("mytable").innerHTML = hstr;
  }

  function getrandomcolor(){
    var life_color = '#EA4335';

    var c = Math.floor(Math.random()*(4-1+1)+1);
    switch(c){ 
      case 1: 
        // 绿色
        life_color = '#34A853';
        break; 
      case 2: 
        // 蓝色
        life_color = '#4285F4';
        break; 
      case 3: 
        // 橙色
        life_color = '#FBBC05';
        break; 
      case 4: 
        // 红色
        life_color = '#EA4335';
        break; 
      default: 
        life_color = '#EA4335';
        break; 
    } 
    return life_color;
  }

  function getlifetable(bdate){
    var now = new Date();
    //var bdate = new Date(e.target.value);
    var n = (now.getFullYear()*12+now.getMonth()+1)-(bdate.getFullYear()*12+bdate.getMonth()+1);

    var hstr = '';

    for (var i=0;i<30;i++){ 
      hstr += '<tr>';
      for (var j=0;j<30;j++){ 
        if (900-n>0){
          hstr += '<td width="7" height="7" style="background:#eeeeee"></td>';
          n++;
        }else{

          hstr += '<td width="7" height="7" style="background:'+getrandomcolor()+'"></td>';
        }
      }
      hstr += '</tr>';
    }

    return hstr;
  }

  function loadlifepassed(e){
    var hstr = '';

    hstr += '<tr><td align="center">人生不过短短的900个月</td></tr>';
    hstr += '<tr><td align="center">如果每过一个月就涂掉一个格子</td></tr>';
    hstr += '<tr><td align="center">全部的人生</td></tr>';
    hstr += '<tr><td align="center">就在这一个30×30的表格上......</td></tr>';

    hstr += '<tr><td align="center">';

    hstr += '<table id="lifetable" border="0" cellspacing="1" cellpadding="1">';

    hstr += getlifetable(new Date("1957-10-17"));

    hstr += '</table>';

    hstr += '</td></tr>';
    
    hstr += '<tr><td align="center">你的人生是否也如此多彩 ？</td></tr>';

    hstr += '<tr><td align="center" style="padding-top:20px">选择生日查看剩余人生：<input type="date" id="bday" value="1957-10-17" onchange="reloadlifepassed(event);"/></td></tr>';

    hstr += '<tr><td align="center" style="padding-top:30px" onclick="loadyearpassed();">︾ ︾ ︾</td></tr>';

    document.getElementById("mytable").innerHTML = hstr;
  }

  function reloadlifepassed(e){
    var hstr = getlifetable(new Date(e.target.value));
    document.getElementById("lifetable").innerHTML = hstr;
  }

</script>
